<!DOCTYPE html>
<html lang="pt-BR">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Teste</title>
</head>
<body>
	<form id="login-form">
		<input type="text" id="input-login"/>
		<input type="password" id="input-senha"/>
		<button>Login</button>
	</form>

	<button id="but-check">Check</button>
	<button id="but-sair">Sair</button>

	<p id="log-status"></p>
	<p id="log"></p>

	<script>
		const form_login = document.getElementById("login-form")

		const input_login = document.getElementById("input-login")
		const input_senha = document.getElementById("input-senha")
		
		const but_check = document.getElementById("but-check")
		const but_sair = document.getElementById("but-sair")

		const p_log_status = document.getElementById("log-status")
		const p_log = document.getElementById("log")

		const link = "http://localhost:3000"

		form_login.addEventListener('submit', (ev) => {
			ev.preventDefault()

			const login = input_login.value
			const senha = input_senha.value

			fetch(link+"/auth/login", {
				body: JSON.stringify( {
					login,
					senha
				}),
				headers: {
    				"Content-Type": "application/json",
  				},
				method: "POST"
			})
			.then(req => {
				p_log_status.textContent = req.status
				return req.json()
			})
			.then(data => {
				console.log(data)
				p_log.textContent = data.mensagem
			})
			.catch(err => {
				p_log.textContent = data.mensagem
			})
		})

		but_check.addEventListener('click', (ev) => {
			fetch(link+"/auth/check")
			.then(req => {
				p_log_status.textContent = req.status
				return req.json()
			})
			.then(data => {
				p_log.textContent = data.mensagem
			})
			.catch(err => {
				p_log.textContent = data.mensagem
			})
		})

		but_sair.addEventListener('click', (ev) => {
			fetch(link+"/auth/sair", {method: "POST"})
			.then(req => {
				p_log_status.textContent = req.status
				return req.json()
			})
			.then(data => {
				p_log.textContent = data.mensagem
			})
			.catch(err => {
				p_log.textContent = data.mensagem
			})
		})
</script>
</body>
</html>